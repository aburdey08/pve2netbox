# Combined mode: quick checks + full sync (recommended for >50 VMs).
# From repo root: edit values below, then:
#   docker compose -f contrib/docker/docker-compose.combined-mode.yml up -d

services:
  pve2netbox:
    image: aburdey/pve2netbox:1.0.3
    environment:
      # PVE API (required — replace with your values)
      - PVE_API_HOST=10.10.0.10
      - PVE_API_USER=netsync@pve
      - PVE_API_TOKEN=test-token
      - PVE_API_SECRET=your-secret-here
      # NetBox API (required — replace with your values)
      - NB_API_URL=https://netbox.example.org
      - NB_API_TOKEN=your-netbox-token-here
      # Optional
      - PVE_API_VERIFY_SSL=false
      - NB_CLUSTER_ID=1
      - NB_API_DELAY_SECONDS=0.2
      - NB_API_RETRY_TOTAL=5
      - NB_API_RETRY_BACKOFF=1.0
      # Combined mode: quick check + full sync
      - QUICK_CHECK_INTERVAL_SECONDS=60
      - SYNC_INTERVAL_SECONDS=3600
      - SYNC_VMS=true
      - SYNC_LXC=true
      - VM_ROLE=Virtual Machine
      - LXC_ROLE=LXC
      - DRY_RUN=false
      - ENABLE_CLEANUP=false
      - LOG_LEVEL=INFO
      - ENABLE_METRICS=false
      - METRICS_PORT=9090
    ports:
      - "9090:9090"
    restart: unless-stopped
